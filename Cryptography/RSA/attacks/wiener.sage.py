
# This file was *autogenerated* from the file wiener.sage
from sage.all_cmdline import *   # import sage library

_sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_4 = Integer(4); _sage_const_1191694878666066510321450623792489136756229172407332230462797663298426983932272792657383336660801913848162204216417540955677965706955404313949733712340714861638106185597684745174398501025724130404133569866642454996521744281284226124355987843894614599718553178595963014434904833 = Integer(1191694878666066510321450623792489136756229172407332230462797663298426983932272792657383336660801913848162204216417540955677965706955404313949733712340714861638106185597684745174398501025724130404133569866642454996521744281284226124355987843894614599718553178595963014434904833); _sage_const_65595858824769808192891452901037754272760510546632850070895475885771790173470530478947051143932089131109731148095866607608229895769111433677080851879406410992918188117601132489070513012020053264559737622906827505456215029118152913305028228589301934744919941466101888696908649374646911404127009253031460258371 = Integer(65595858824769808192891452901037754272760510546632850070895475885771790173470530478947051143932089131109731148095866607608229895769111433677080851879406410992918188117601132489070513012020053264559737622906827505456215029118152913305028228589301934744919941466101888696908649374646911404127009253031460258371); _sage_const_135568509670260054049994954417860747085442883428459182441559553532993752593294067458983143521109377661295622146963670193783017382697726454953197805014428888491744355387957923382241961401063461549210355871385000347645387907568135032087942016502668629010859519249039662555733548461551175133582871220209515648241 = Integer(135568509670260054049994954417860747085442883428459182441559553532993752593294067458983143521109377661295622146963670193783017382697726454953197805014428888491744355387957923382241961401063461549210355871385000347645387907568135032087942016502668629010859519249039662555733548461551175133582871220209515648241)
from sage.all import *
from Crypto.Util.number import *
import gmpy

def wiener(e,n,C) :
    c=(e/n).continued_fraction()
    for i in c.convergents() :
        k=numerator(i)
        d=denominator(i)
        if(k==_sage_const_0 ):
            continue
        phi=(e*d-_sage_const_1 )/k
        if(d%_sage_const_2 !=_sage_const_0  and phi.is_integer()) :
            b=(n-phi+_sage_const_1 )
            D=((b**_sage_const_2 ) - _sage_const_4 *n)
            if(D>=_sage_const_0 ) :
                p= (b+sqrt(D))/_sage_const_2 
                q= (b-sqrt(D))/_sage_const_2 
                if(p.is_integer() and q.is_integer()) :
                    d=inverse_mod(e,phi)
                    m=long(pow(C,d,n))
                    print long_to_bytes(m)
                    return d


def _test() :
    n=_sage_const_135568509670260054049994954417860747085442883428459182441559553532993752593294067458983143521109377661295622146963670193783017382697726454953197805014428888491744355387957923382241961401063461549210355871385000347645387907568135032087942016502668629010859519249039662555733548461551175133582871220209515648241 
    e=_sage_const_1191694878666066510321450623792489136756229172407332230462797663298426983932272792657383336660801913848162204216417540955677965706955404313949733712340714861638106185597684745174398501025724130404133569866642454996521744281284226124355987843894614599718553178595963014434904833 
    C=_sage_const_65595858824769808192891452901037754272760510546632850070895475885771790173470530478947051143932089131109731148095866607608229895769111433677080851879406410992918188117601132489070513012020053264559737622906827505456215029118152913305028228589301934744919941466101888696908649374646911404127009253031460258371 
    m=bytes_to_long("This is a flag")
    c=pow(m,e,n)
    print wiener(e,n,c)

if __name__ =="__main__" :

	_test()
    
	e=int(raw_input("e :"))
	n=int(raw_input("n :"))
	C=int(raw_input("C :"))
	print("d" , wiener(e,n,C))



